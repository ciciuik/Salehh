<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Share Location</title>
</head>
<body>
  <h1>مشاركة الموقع</h1>
  <button id="getLocation">مشاركة موقعي</button>

  <script>
    document.getElementById('getLocation').onclick = function () {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success, error);
      } else {
        alert("المتصفح لا يدعم تحديد الموقع");
      }
    };

    function success(position) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

      fetch('/api/save-location', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ lat, lon })
      })
      .then(res => res.json())
      .then(data => {
        alert(data.message);
      })
      .catch(err => {
        console.error(err);
      });
    }

    function error() {
      alert("لم يتم السماح بمشاركة الموقع");
    }
  </script>
</body>
</html>
